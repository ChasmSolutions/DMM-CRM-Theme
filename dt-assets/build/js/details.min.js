"use strict";function record_updated(updateNeeded){$(".update-needed-notification").toggle(updateNeeded),$(".update-needed").prop("checked",updateNeeded)}jQuery(document).ready((function($){let post_id=window.detailsSettings.post_id,post_type=window.detailsSettings.post_type,post=window.detailsSettings.post_fields,field_settings=window.detailsSettings.post_settings.fields;window.post_type_fields=field_settings;let rest_api=window.API,typeaheadTotals={};window.masonGrid=$(".grid"),$("input.text-input").change((function(){const id=$(this).attr("id"),val=$(this).val();$(`#${id}-spinner`).addClass("active"),rest_api.update_post(post_type,post_id,{[id]:val}).then((newPost=>{$(`#${id}-spinner`).removeClass("active"),$(document).trigger("text-input-updated",[newPost,id,val])})).catch(handleAjaxError)})),$(".dt_textarea").change((function(){const id=$(this).attr("id"),val=$(this).val();$(`#${id}-spinner`).addClass("active"),rest_api.update_post(post_type,post_id,{[id]:val}).then((newPost=>{$(`#${id}-spinner`).removeClass("active"),$(document).trigger("text-input-updated",[newPost,id,val])})).catch(handleAjaxError)})),$("button.dt_multi_select").on("click",(function(){let fieldKey=$(this).data("field-key"),optionKey=$(this).attr("id"),fieldValue={},field=jQuery(`[data-field-key="${fieldKey}"]#${optionKey}`);field.addClass("submitting-select-button");let action="add";field.hasClass("selected-select-button")?(fieldValue.values=[{value:optionKey,delete:!0}],action="delete"):(field.removeClass("empty-select-button"),field.addClass("selected-select-button"),fieldValue.values=[{value:optionKey}]),$(`#${fieldKey}-spinner`).addClass("active"),rest_api.update_post(post_type,post_id,{[fieldKey]:fieldValue}).then((resp=>{$(`#${fieldKey}-spinner`).removeClass("active"),field.removeClass("submitting-select-button selected-select-button"),field.blur(),field.addClass("delete"===action?"empty-select-button":"selected-select-button"),$(document).trigger("dt_multi_select-updated",[resp,fieldKey,optionKey,action])})).catch((err=>{field.removeClass("submitting-select-button selected-select-button"),field.addClass("add"===action?"empty-select-button":"selected-select-button"),handleAjaxError(err)}))})),$(".dt_date_picker").datepicker({constrainInput:!1,dateFormat:"yy-mm-dd",onClose:function(date){if(document.querySelector("#group-details-edit-modal")&&document.querySelector("#group-details-edit-modal").contains(this));else{date=window.SHAREDFUNCTIONS.convertArabicToEnglishNumbers(date),$(this).val()||(date=" ");let id=$(this).attr("id");$(`#${id}-spinner`).addClass("active"),rest_api.update_post(post_type,post_id,{[id]:moment.utc(date).unix()}).then((resp=>{$(`#${id}-spinner`).removeClass("active"),this.value&&(this.value=window.SHAREDFUNCTIONS.formatDate(resp[id].timestamp)),$(document).trigger("dt_date_picker-updated",[resp,id,date])})).catch(handleAjaxError)}},changeMonth:!0,changeYear:!0,yearRange:"1900:2050"}).each((function(){this.value&&moment.unix(this.value).isValid()&&(this.value=window.SHAREDFUNCTIONS.formatDate(this.value))})),$(".clear-date-button").click((function(){let input_id=this.dataset.inputid;$(`#${input_id}`).val("");$(`#${input_id}-spinner`).addClass("active"),rest_api.update_post(post_type,post_id,{[input_id]:null}).then((resp=>{$(`#${input_id}-spinner`).removeClass("active"),$(document).trigger("dt_date_picker-updated",[resp,input_id,null])})).catch(handleAjaxError)})),$("select.select-field").change((e=>{const id=$(e.currentTarget).attr("id"),val=$(e.currentTarget).val();$(`#${id}-spinner`).addClass("active"),rest_api.update_post(post_type,post_id,{[id]:val}).then((resp=>{$(`#${id}-spinner`).removeClass("active"),$(document).trigger("select-field-updated",[resp,id,val]),$(e.currentTarget).hasClass("color-select")&&$(`#${id}`).css("background-color",window.lodash.get(window.detailsSettings,`post_settings.fields[${id}].default[${val}].color`))})).catch(handleAjaxError)})),$("input.number-input").on("blur",(function(){const id=$(this).attr("id"),val=$(this).val();$(`#${id}-spinner`).addClass("active"),rest_api.update_post(post_type,post_id,{[id]:val}).then((resp=>{$(`#${id}-spinner`).removeClass("active"),$(document).trigger("number-input-updated",[resp,id,val])})).catch(handleAjaxError)})),$(".dt_contenteditable").on("blur",(function(){const id=$(this).attr("id");let val=$(this).text();rest_api.update_post(post_type,post_id,{[id]:val}).then((resp=>{$(document).trigger("contenteditable-updated",[resp,id,val])})).catch(handleAjaxError)})),$("button.add-button").on("click",(e=>{const field=$(e.currentTarget).data("list-class");$(`#edit-${field}`).append(`<div class="input-group">\n            <input type="text" data-field="${window.lodash.escape(field)}" class="dt-communication-channel input-group-field" dir="auto" />\n            <div class="input-group-button">\n            <button class="button alert input-height delete-button-style channel-delete-button delete-button new-${window.lodash.escape(field)}" data-key="new" data-field="${window.lodash.escape(field)}">&times;</button>\n            </div></div>`)})),$(document).on("click",".channel-delete-button",(function(){let field=$(this).data("field"),key=$(this).data("key"),update={delete:!0};"new"===key?$(this).parent().remove():key&&($(`#${field}-spinner`).addClass("active"),update.key=key,API.update_post(post_type,post_id,{[field]:[update]}).then((updatedContact=>{$(this).parent().parent().remove();let list=$(`#edit-${field}`);0===list.children().length&&list.append(`<div class="input-group">\n            <input type="text" data-field="${window.lodash.escape(field)}" class="dt-communication-channel input-group-field" dir="auto" />\n            </div>`),$(`#${field}-spinner`).removeClass("active"),post=updatedContact,resetDetailsFields()})).catch(handleAjaxError))})),$(document).on("blur","input.dt-communication-channel",(function(){let field_key=$(this).data("field"),value=$(this).val(),id=$(this).attr("id"),update={value:value};id&&(update.key=id),$(`#${field_key}-spinner`).addClass("active"),API.update_post(post_type,post_id,{[field_key]:[update]}).then((updatedContact=>{$(`#${field_key}-spinner`).removeClass("active");let key=window.lodash.last(updatedContact[field_key]).key;$(this).attr("id",key),1===$(this).next("div.input-group-button").length?(console.log("present"),$(this).parent().find(".channel-delete-button").data("key",key)):(console.log("new x"),$(this).parent().append(`<div class="input-group-button">\n            <button class="button alert delete-button-style input-height channel-delete-button delete-button" data-key="${window.lodash.escape(key)}" data-field="${window.lodash.escape(field_key)}">&times;</button>\n        </div>`)),post=updatedContact,resetDetailsFields()})).catch(handleAjaxError)})),$(document).on("select-field-updated",(function(e,newContact,id,val){})),$(document).on("text-input-updated",(function(e,newContact,id,val){"name"===id&&($("#title").html(window.lodash.escape(val)),$("#second-bar-name").text(window.lodash.escape(val)))})),$(document).on("contenteditable-updated",(function(e,newContact,id,val){"title"===id&&($("#name").val(window.lodash.escape(val)),$("#second-bar-name").text(window.lodash.escape(val)))})),$(document).on("dt_date_picker-updated",(function(e,newContact,id,date){})),$(document).on("dt_multi_select-updated",(function(e,newContact,fieldKey,optionKey,action){})),$(document).on("dt_record_updated",(function(e,response,request){post=response,resetDetailsFields(),record_updated(window.lodash.get(response,"requires_update",!1))})),$(".update-needed.dt-switch").change((function(){let updateNeeded=$(this).is(":checked");API.update_post(post_type,post_id,{requires_update:updateNeeded}).then((resp=>{post=resp}))})),$(".show-details-section").on("click",(function(){$("#details-section").toggle(),$("#show-details-edit-button").toggle(),$("#details-section .typeahead__query input").each(((i,element)=>{let field_key=$(element).data("field");Typeahead[`.js-typeahead-${field_key}`]&&Typeahead[`.js-typeahead-${field_key}`].adjustInputSize()}))})),$(".dt_typeahead").each(((key,el)=>{let field_id=$(el).attr("id").replace("_connection",""),listing_post_type=window.lodash.get(window.detailsSettings.post_settings.fields[field_id],"post_type","contacts");$.typeahead({input:`.js-typeahead-${field_id}`,minLength:0,accent:!0,maxItem:30,searchOnFocus:!0,template:window.TYPEAHEADS.contactListRowTemplate,matcher:function(item){return parseInt(item.ID)!==parseInt(post_id)},source:window.TYPEAHEADS.typeaheadPostsSource(listing_post_type,{field_key:field_id}),display:"name",templateValue:"{{name}}",dynamic:!0,multiselect:{matchOn:["ID"],data:function(){return(post[field_id]||[]).map((g=>({ID:g.ID,name:g.post_title})))},callback:{onCancel:function(node,item){$(`#${field_id}-spinner`).addClass("active"),API.update_post(post_type,post_id,{[field_id]:{values:[{value:item.ID,delete:!0}]}}).then((()=>{$(`#${field_id}-spinner`).removeClass("active")})).catch((err=>{console.error(err)}))}},href:window.wpApiShare.site_url+`/${listing_post_type}/{{ID}}`},callback:{onClick:function(node,a,item,event){$(`#${field_id}-spinner`).addClass("active"),API.update_post(post_type,post_id,{[field_id]:{values:[{value:item.ID}]}}).then((new_post=>{$(`#${field_id}-spinner`).removeClass("active"),$(document).trigger("dt-post-connection-added",[new_post,field_id])})).catch((err=>{console.error(err)})),this.addMultiselectItemLayout(item),event.preventDefault(),this.hideLayout(),this.resetInput(),masonGrid.masonry("layout")},onResult:function(node,query,result,resultCount){let text=TYPEAHEADS.typeaheadHelpText(resultCount,query,result);$(`#${field_id}-result-container`).html(text)},onHideLayout:function(event,query){query||$(`#${field_id}-result-container`).empty(),masonGrid.masonry("layout")},onShowLayout(){masonGrid.masonry("layout")}}})}));for(let input of $(".multi_select .typeahead__query input")){let field=$(input).data("field"),typeahead_name=`.js-typeahead-${field}`;if(window.Typeahead[typeahead_name])return;let source_data={data:[]},field_options=window.lodash.get(field_settings,`${field}.default`,{});Object.keys(field_options).length>0?window.lodash.forOwn(field_options,((val,key)=>{val.deleted||source_data.data.push({key:key,name:key,value:val.label||key})})):source_data={[field]:{display:["value"],ajax:{url:window.wpApiShare.root+`dt-posts/v2/${post_type}/multi-select-values`,data:{s:"{{query}}",field:field},beforeSend:function(xhr){xhr.setRequestHeader("X-WP-Nonce",window.wpApiShare.nonce)},callback:{done:function(data){return(data||[]).map((tag=>({value:window.lodash.get(field_options,tag+".label",tag),key:tag})))}}}}},$.typeahead({input:`.js-typeahead-${field}`,minLength:0,maxItem:20,searchOnFocus:!0,template:function(query,item){return`<span>${window.lodash.escape(item.value)}</span>`},source:source_data,display:"value",templateValue:"{{value}}",dynamic:!0,multiselect:{matchOn:["key"],data:function(){return(post[field]||[]).map((g=>({key:g,value:window.lodash.get(field_settings,`${field}.default.${g}.label`,g)})))},callback:{onCancel:function(node,item,event){$(`#${field}-spinner`).addClass("active"),API.update_post(post_type,post_id,{[field]:{values:[{value:item.key,delete:!0}]}}).then((new_post=>{$(`#${field}-spinner`).removeClass("active"),this.hideLayout(),this.resetInput(),$(document).trigger("dt_multi_select-updated",[new_post,field])})).catch((err=>{console.error(err)}))}}},callback:{onClick:function(node,a,item,event){$(`#${field}-spinner`).addClass("active"),API.update_post(post_type,post_id,{[field]:{values:[{value:item.key}]}}).then((new_post=>{$(`#${field}-spinner`).removeClass("active"),$(document).trigger("dt_multi_select-updated",[new_post,field]),this.addMultiselectItemLayout(item),event.preventDefault(),this.hideLayout(),this.resetInput()})).catch((err=>{console.error(err)}))},onResult:function(node,query,result,resultCount){let text=TYPEAHEADS.typeaheadHelpText(resultCount,query,result);$(`#${field}-result-container`).html(text)},onHideLayout:function(){$(`#${field}-result-container`).html("")}}})}let connection_type=null;$(".create-new-record").on("click",(function(){connection_type=$(this).data("connection-key"),$("#create-record-modal").foundation("open"),$(".js-create-record .error-text").empty(),$(".js-create-record-button").attr("disabled",!1).removeClass("alert"),$(".reveal-after-record-create").hide(),$(".hide-after-record-create").show(),$(".js-create-record input[name=title]").val("")})),$(".js-create-record").on("submit",(function(e){e.preventDefault(),$(".js-create-record-button").attr("disabled",!0).addClass("loading");let title=$(".js-create-record input[name=title]").val();if(!connection_type)return void $(".js-create-record .error-text").text("Something went wrong. Please refresh and try again");let update_field=connection_type;API.create_post(field_settings[update_field].post_type,{title:title}).then((newRecord=>API.update_post(post_type,post_id,{[update_field]:{values:[{value:newRecord.ID}]}}).then((response=>{$(".js-create-record-button").attr("disabled",!1).removeClass("loading"),$(".reveal-after-record-create").show(),$("#new-record-link").html(`<a href="${window.lodash.escape(newRecord.permalink)}">${window.lodash.escape(title)}</a>`),$(".hide-after-record-create").hide(),$("#go-to-record").attr("href",window.lodash.escape(newRecord.permalink)),post=response,$(document).trigger("dt-post-connection-created",[post,update_field]),Typeahead[`.js-typeahead-${connection_type}`]&&(Typeahead[`.js-typeahead-${connection_type}`].addMultiselectItemLayout({ID:newRecord.ID.toString(),name:title}),masonGrid.masonry("layout"))})))).catch((function(error){$(".js-create-record-button").removeClass("loading").addClass("alert"),$(".js-create-record .error-text").text(window.lodash.get(error,"responseJSON.message","Something went wrong. Please refresh and try again")),console.error(error)}))})),$(".dt_location_grid").each(((key,el)=>{let field_id=$(el).data("id")||"location_grid";$.typeahead({input:`.js-typeahead-${field_id}`,minLength:0,accent:!0,searchOnFocus:!0,maxItem:20,dropdownFilter:[{key:"group",value:"focus",template:window.lodash.escape(window.wpApiShare.translations.regions_of_focus),all:window.lodash.escape(window.wpApiShare.translations.all_locations)}],source:{focus:{display:"name",ajax:{url:window.wpApiShare.root+"dt/v1/mapping_module/search_location_grid_by_name",data:{s:"{{query}}",filter:function(){return window.lodash.get(window.Typeahead[`.js-typeahead-${field_id}`].filters.dropdown,"value","all")}},beforeSend:function(xhr){xhr.setRequestHeader("X-WP-Nonce",window.wpApiShare.nonce)},callback:{done:function(data){return void 0!==typeaheadTotals&&(typeaheadTotals.field=data.total),data.location_grid}}}}},display:"name",templateValue:"{{name}}",dynamic:!0,multiselect:{matchOn:["ID"],data:function(){return(post[field_id]||[]).map((g=>({ID:g.id,name:g.label})))},callback:{onCancel:function(node,item){API.update_post(post_type,post_id,{[field_id]:{values:[{value:item.ID,delete:!0}]}}).catch((err=>{console.error(err)}))}}},callback:{onClick:function(node,a,item,event){API.update_post(post_type,post_id,{[field_id]:{values:[{value:item.ID}]}}).catch((err=>{console.error(err)})),this.addMultiselectItemLayout(item),event.preventDefault(),this.hideLayout(),this.resetInput(),masonGrid.masonry("layout")},onReady(){this.filters.dropdown={key:"group",value:"focus",template:window.lodash.escape(window.wpApiShare.translations.regions_of_focus)},this.container.removeClass("filter").find("."+this.options.selector.filterButton).html(window.lodash.escape(window.wpApiShare.translations.regions_of_focus))},onResult:function(node,query,result,resultCount){resultCount=typeaheadTotals[field_id];let text=TYPEAHEADS.typeaheadHelpText(resultCount,query,result);$(`#${field_id}-result-container`).html(text)},onHideLayout:function(){$(`#${field_id}-result-container`).html("")}}})})),$("button.follow").on("click",(function(){let following=!("following"===$(this).data("value"));$(this).data("value",following?"following":""),$(this).hasClass("mobile")?$(this).html("<i class='fi-eye'></i>"):$(this).html(following?"Following <i class='fi-eye'></i>":"Follow <i class='fi-eye'></i>"),$(this).toggleClass("hollow");let update={follow:{values:[{value:window.detailsSettings.current_user_id,delete:!following}]},unfollow:{values:[{value:window.detailsSettings.current_user_id,delete:following}]}};rest_api.update_post(post_type,post_id,update)}));let shareTypeahead=null;$(".open-share").on("click",(function(){$("#share-contact-modal").foundation("open"),shareTypeahead||(shareTypeahead=TYPEAHEADS.share(post_type,post_id,!["contacts","groups"].includes(window.detailsSettings.post_type)))}));let build_task_list=()=>{let tasks=window.lodash.sortBy(post.tasks||[],["date"]).reverse(),html="";tasks.forEach((task=>{let task_done="reminder"===task.category&&"notification_sent"===task.value.notification||"reminder"!==task.category&&"task_complete"===task.value.status,show_complete_button="reminder"!==task.category&&"task_complete"!==task.value.status,task_row=`<strong>${window.lodash.escape(moment(task.date).format("MMM D YYYY"))}</strong> `;"reminder"===task.category?(task_row+=window.lodash.escape(window.detailsSettings.translations.reminder),task.value.note&&(task_row+=" "+window.lodash.escape(task.value.note))):task_row+=window.lodash.escape(task.value.note||window.detailsSettings.translations.no_note),html+=`<li>\n        <span style="${task_done?"text-decoration:line-through":""}">\n        ${task_row}\n        ${show_complete_button?`<button type="button" data-id="${window.lodash.escape(task.id)}" class="existing-task-action complete-task">${window.lodash.escape(window.detailsSettings.translations.complete).toLowerCase()}</button>`:""}\n        <button type="button" data-id="${window.lodash.escape(task.id)}" class="existing-task-action remove-task" style="color: red;">${window.lodash.escape(window.detailsSettings.translations.remove).toLowerCase()}</button>\n      </li>`})),html?$("#tasks-modal .existing-tasks").html(html):$("#tasks-modal .existing-tasks").html(`<li>${window.lodash.escape(window.detailsSettings.translations.no_tasks)}</li>`),$(".complete-task").on("click",(function(){$("#tasks-spinner").addClass("active");let id=$(this).data("id");API.update_post(post_type,post_id,{tasks:{values:[{id:id,value:{status:"task_complete"}}]}}).then((resp=>{post=resp,build_task_list(),$("#tasks-spinner").removeClass("active")}))})),$(".remove-task").on("click",(function(){$("#tasks-spinner").addClass("active");let id=$(this).data("id");API.update_post(post_type,post_id,{tasks:{values:[{id:id,delete:!0}]}}).then((resp=>{post=resp,build_task_list(),$("#tasks-spinner").removeClass("active")}))}))};$(".open-set-task").on("click",(function(){$(".js-add-task-form .error-text").empty(),build_task_list(),$("#tasks-modal").foundation("open")})),$("#task-custom-text").on("click",(function(){$('input:radio[name="task-type"]').filter('[value="custom"]').prop("checked",!0)})),$("#create-task-date").daterangepicker({singleDatePicker:!0,locale:{format:"YYYY/MM/DD",separator:" - ",daysOfWeek:window.wpApiShare.translations.days_of_the_week,monthNames:window.wpApiShare.translations.month_labels},firstDay:1,startDate:moment().add(1,"day"),opens:"center",drops:"down"});let task_note=$("#tasks-modal #task-custom-text");function resetDetailsFields(){window.lodash.forOwn(field_settings,((field_options,field_key)=>{if("details"===field_options.tile&&!field_options.hidden&&post[field_key]){if(field_options.only_for_types&&post.type&&!field_options.only_for_types.includes(post.type.key))return;let field_value=window.lodash.get(post,field_key,!1),values_html="";"text"===field_options.type?values_html=window.lodash.escape(field_value):"date"===field_options.type?values_html=window.lodash.escape(window.SHAREDFUNCTIONS.formatDate(field_value.timestamp)):"key_select"===field_options.type?values_html=window.lodash.escape(field_value.label):"multi_select"===field_options.type?values_html=field_value.map((v=>`${window.lodash.escape(window.lodash.get(field_options,`default[${v}].label`,v))}`)).join(", "):["location","location_meta"].includes(field_options.type)?values_html=field_value.map((v=>window.lodash.escape(v.label))).join(" / "):"communication_channel"===field_options.type?values_html=field_value.map((v=>window.lodash.escape(v.value))).join(", "):["connection"].includes(field_options.type)&&(values_html=field_value.map((v=>window.lodash.escape(v.label))).join(", ")),$(`#collapsed-detail-${field_key}`).toggle(""!==values_html),"contact_phone"==field_key?$(`#collapsed-detail-${field_key} .collapsed-items`).html(`<a dir="auto" href="tel:${values_html}" title="${values_html}">${values_html}</span>`):$(`#collapsed-detail-${field_key} .collapsed-items`).html(`<span title="${values_html}">${values_html}</span>`)}})),$(document).trigger("dt_record_details_reset",[post])}$(".js-add-task-form").on("submit",(function(e){e.preventDefault(),$("#create-task").attr("disabled",!0).addClass("loading");let date=$("#create-task-date").data("daterangepicker").startDate,note=task_note.val(),task_type=$('#tasks-modal input[name="task-type"]:checked').val();API.update_post(post_type,post_id,{tasks:{values:[{date:date.startOf("day").add(8,"hours").format(),value:{note:note},category:task_type}]}}).then((resp=>{post=resp,$("#create-task").attr("disabled",!1).removeClass("loading"),task_note.val(""),$("#tasks-modal").foundation("close")})).catch((err=>{$("#create-task").attr("disabled",!1).removeClass("loading"),$(".js-add-task-form .error-text").html(window.lodash.escape(window.lodash.get(err,"responseJSON.message"))),console.error(err)}))})),$(".js-typeahead-tags").length&&($.typeahead({input:".js-typeahead-tags",minLength:0,maxItem:20,searchOnFocus:!0,source:{tags:{display:["name"],ajax:{url:window.wpApiShare.root+`dt-posts/v2/${post_type}/multi-select-values`,data:{s:"{{query}}",field:"tags"},beforeSend:function(xhr){xhr.setRequestHeader("X-WP-Nonce",window.wpApiShare.nonce)},callback:{done:function(data){return(data||[]).map((tag=>({name:tag})))}}}}},display:"name",templateValue:"{{name}}",dynamic:!0,multiselect:{matchOn:["name"],data:function(){return(post.tags||[]).map((t=>({name:t})))},callback:{onCancel:function(node,item){API.update_post(post_type,post_id,{tags:{values:[{value:item.name,delete:!0}]}})}}},callback:{onClick:function(node,a,item,event){API.update_post(post_type,post_id,{tags:{values:[{value:item.name}]}}),this.addMultiselectItemLayout(item),event.preventDefault(),this.hideLayout(),this.resetInput(),masonGrid.masonry("layout")},onResult:function(node,query,result,resultCount){let text=TYPEAHEADS.typeaheadHelpText(resultCount,query,result);$("#tags-result-container").html(text),masonGrid.masonry("layout")},onHideLayout:function(){$("#tags-result-container").html(""),masonGrid.masonry("layout")},onShowLayout(){masonGrid.masonry("layout")}}}),$("#create-tag-return").on("click",(function(){let tag=$("#new-tag").val();Typeahead[".js-typeahead-tags"].addMultiselectItemLayout({name:tag}),API.update_post(post_type,post_id,{tags:{values:[{value:tag}]}})}))),resetDetailsFields(),$("#delete-record").on("click",(function(){$(this).attr("disabled",!0).addClass("loading"),API.delete_post(post_type,post_id).then((()=>{window.location="/"+post_type}))})),$("#archive-record").on("click",(function(){$(this).attr("disabled",!0).addClass("loading"),API.update_post(post_type,post_id,{overall_status:"closed"}).then((()=>{$(this).attr("disabled",!1).removeClass("loading"),$("#archive-record-modal").foundation("close"),$(".archived-notification").show()}))})),$("#unarchive-record").on("click",(function(){$(this).attr("disabled",!0).addClass("loading"),API.update_post(post_type,post_id,{overall_status:"active"}).then((()=>{$(this).attr("disabled",!1).removeClass("loading"),$(".archived-notification").hide()}))})),$(".reveal").on("open.zf.reveal",(function(){const firstField=$(this).find("input").filter(":not([disabled],[hidden],[opacity=0]):visible:first");0!==firstField.length&&firstField.focus()})),masonGrid.masonry({itemSelector:".grid-item",percentPosition:!0})}));
//# sourceMappingURL=details.min.js.map
